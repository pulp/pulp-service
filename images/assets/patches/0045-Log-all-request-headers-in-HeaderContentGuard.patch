From 0309bbf2098fa4ca40fe863a1da01fff0c3bf632 Mon Sep 17 00:00:00 2001
From: Dennis Kliban <dkliban@redhat.com>
Date: Wed, 25 Feb 2026 20:36:05 -0500
Subject: [PATCH] Log all request headers in HeaderContentGuard.permit()

Adds an info-level log statement at the start of permit() so that all
headers submitted with the request are visible when troubleshooting
access-control issues.

Co-Authored-By: Claude Sonnet 4.6 <noreply@anthropic.com>
---
 pulpcore/app/models/publication.py | 1 +
 1 file changed, 1 insertion(+)

diff --git a/pulpcore/app/models/publication.py b/pulpcore/app/models/publication.py
index f354f0dd5..c4467d5de 100644
--- a/pulpcore/app/models/publication.py
+++ b/pulpcore/app/models/publication.py
@@ -483,6 +483,7 @@ class HeaderContentGuard(ContentGuard, AutoAddObjPermsMixin):
     jq_filter = models.TextField(null=True)
 
     def permit(self, request):
+        _logger.info("HeaderContentGuard request headers: %s", dict(request.headers))
         header_content = request.headers.get(self.header_name)
         if not header_content:
             _logger.debug(
-- 
2.52.0

